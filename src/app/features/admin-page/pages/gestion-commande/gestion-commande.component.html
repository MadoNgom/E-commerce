<div class="container">
    <div class="py-2">
        <h2>Liste des commandes</h2>
      </div>
    <ng-container *ngIf="orders$ | async as orders">
      <table mat-table [dataSource]="orders">
        <ng-container matColumnDef="Image">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Image </th>
          <td mat-cell *matCellDef="let element">
             <img [src]="element.product?.images[0]" class="h-10 w-10"/>
            </td>
        </ng-container>
        <ng-container matColumnDef="Nom produit">
          <th mat-header-cell *matHeaderCellDef>Nom produit </th>
          <td mat-cell *matCellDef="let element"> {{element.product?.name}} </td>
        </ng-container>
        <ng-container matColumnDef="Client">
          <th mat-header-cell *matHeaderCellDef>Client </th>
          <td mat-cell *matCellDef="let element">
            <img [src]="element.users?.imageUrl" class="h-10 w-10 mr-2 rounded-full"/> {{element.user?.firstname + ' ' + element.user?.lastname}}
          </td>
        </ng-container>
        <ng-container matColumnDef="Quantité">
            <th mat-header-cell *matHeaderCellDef>Quantité </th>
            <td mat-cell *matCellDef="let element">
              {{element.quantity}}
            </td>
          </ng-container>
          <ng-container matColumnDef="Prix unitaire">
            <th mat-header-cell *matHeaderCellDef>Prix unitaire </th>
            <td mat-cell *matCellDef="let element">
              {{element.product?.price}} F cfa
            </td>
          </ng-container>
          <ng-container matColumnDef="Statut">
            <th mat-header-cell *matHeaderCellDef>Statut </th>
            <td mat-cell *matCellDef="let element">
                <p-tag 
                *ngIf="element.isValidate" 
                value="Valider" 
                styleClass="p-mr-2" 
                severity="success">
              </p-tag>
              <p-tag 
                *ngIf="!element.role" 
                value="Attente" 
                styleClass="p-mr-2" 
                severity="warning">
              </p-tag>
            </td>
          </ng-container>
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef> Actions </th>
          <td mat-cell *matCellDef="let element">
            <button class="border border-white rounded bg-amber-400  text-slate-900 p-2" *ngIf="!element.isValidate">Valider</button>
            <button class="border border-white rounded bg-red-400  text-slate-900 p-2">Rejeter</button>
          </td>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>
    </ng-container>
    <mat-paginator showFirstLastButtons class="mt-2" [length]="totalOrders" [pageSize]="5" [pageSizeOptions]="pageSizeOptions"
      (pageSizeChange)="onPageSizeChange($event)" (page)="onPageChange($event)"></mat-paginator>
  </div>